# comparator-network
基于的mlpcnn的短文本匹配网络模型


1)	数据预处理
由于机器的性能限制以及完整保留语义特征的考虑，此处仅使用中文字符级别的原始特征。也就是说使用预先准备好的词汇表，将pointwise型的文本对-标签数据，转化为索引对-标签数据。
在将数据投喂给模型之前，先按照设定的序列长度进行填充处理，过长的序列从首部或尾部进行截断，长度固定为64。
2)	网络结构
Simnet项目的网络结构有很多种，本实验中使用CNN-pointwise结构配置进行训练。
模型首先经过嵌入层，嵌入层使用随机初始化的方式进行变量初始化。嵌入层之后是一维卷积，卷积核的数目为256个。将两个文本对分别经过两个卷积层，得到query和doc张量的形状都是[batch_size, 256]。
这之后使用连接函数，将两个256维的向量连接起来，形成512维的向量。
将该[batch_size, 512]形状的张量经过两层全联接网络，第一层全联接网络的hidden_size设定为128，第二层全联接网络的神经元数目设置为类别数，也就是2，激活函数使用RELU函数。
损失函数使用交叉熵损失函数。
3)	训练与测试
训练的批次样本数目为64，一共训练10个历元，每个历元的迭代次数为int((样本总数-1)/64)+1。测试数据的格式与训练数据的组织形式一模一样，也就是每一行由query和doc文本对组成。
4)  结果
使用pair网络，在微众银行测试集的精度为	87.41%
